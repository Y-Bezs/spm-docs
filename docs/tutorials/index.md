# SPM Course for MEG/EEG : May 30 - June 2, 2023

!!! info "Note"
    This page is under constructions and we'll add additionals materials prior to and during the course.

The course will present instruction on the analysis of EEG and MEG data. The first three days will combine theoretical presentations with practical demonstrations of the different data analysis methods implemented in SPM. On the last day participants will have the opportunity to work on SPM tutorial data sets under the supervision of the course faculty. We also invite students to use their own data for analysis. The course is suitable for both beginners and more advanced users. We advise students to gain at least some minimal familiarity with the methodology, for example, from reading introductory articles available from the [SPM web page](https://www.fil.ion.ucl.ac.uk/spm/doc/) or by scanning through [Litvak et al. (2011)](https://doi.org/10.1155/2011/852961) or [Henson et al. (2019)](https://doi.org/10.3389/fnins.2019.00300).

## Programme {#programme}

All times are local **London** (England, United Kingdom) time (**BST**).

<!--The course will take place in **Zoom**. We will send you an email with instructions on how to join in (or see below).

Each lecture will be **streamed live** at the indicated time and also available **on-demand** through the link.

Each lecture will be followed by some **time for questions** from the audience and a **short break** before the next lecture.

**Questions** can be asked at any time during the lectures using the **chat window** or the **[Slack channel](https://bit.ly/3b5kLpm)**: we will aim at answering them at the end of each lecture or during the **Q&A sessions**.

Please do not share the link to this webpage publicly as it contains information for the participants of the course only (Zoom login).-->

### Tuesday 30 May

Location: **12 Queen Square, 4th floor Seminar Room**

<!--Join us on **Zoom** (Chair: Meaghan Spedden) -->

| Time         | Event                             | Speaker            |
|--------------|-----------------------------------|--------------------|
| 09:45 - 10:15 | Welcome and registration    |  |
| 10:15 - 10:30 | SPM introduction and resources | Vladimir Litvak |
| 10:30 - 11:30 | What are we measuring with M/EEG| Moritz Gerster|
| 11:30 - 12:45 | Data pre-processing | Catharina Zich |
| 12:45 - 13:30 | Lunch break                                          |
| 13:30 - 14:40 | Data pre-processing demo |Ryan Timms           |
| 14:40 - 15:45 | General linear model and classical inference |Christophe Phillips|
| 15:45 - 16:15 | Break    ||
| 16:15 - 16:45 | Convolutional GLM|Johan Medrano|
| 16:45 - 17:45 | Multiple comparisons problems and solutions|Tim Tierney|
| 17:45 - 18:30 | General Q&A (All faculty)                        |

### Wednesday 31 May

Location: **12 Queen Square, 4th floor Seminar Room**
<!--Join us on **Zoom** (Chair: Heather Payne)-->

| Time         | Event                             | Speaker            |
|--------------|-----------------------------------|--------------------|
| 09:30 - 10:00 | Welcome and registration    |  |
| 10:00 - 12:00 | Group M/EEG dataset analysis - demo|Jason Taylor|
| 12:00 - 12:40 | Analysis of Optically Pumped Magnetometers (OPM) data|Stephanie Mellor|
| 12:40 - 13:15 | OPM data analysis - demo | Robert Seymour |
| 13:15 - 14:15 | Lunch break                                          |
| 14:15 - 15:15 | Bayesian inference|Noor Sajid|
| 15:15 - 16:15 | M/EEG source analysis |Jose David Lopez|
| 16:15 - 16:45 | Break    ||
| 16:15 - 16:45 | M/EEG source analysis -demo |Mansoureh Fahimi|
| 17:30 - 18:30 | General Q&A (All faculty)     ||   
| 18:30 -       | Social event (FIL Conservatory)||

### Thursday 1 June

Location: **12 Queen Square, 4th floor Seminar Room**

<!--Join us on **Zoom** (Chair: Dorothea Hämmerer)-->

| Time         | Event                             | Speaker            |
|--------------|-----------------------------------|--------------------|
| 09:30 - 10:00 | Welcome and registration    |  |
| 10:00 - 11:30 | The principles of dynamic causal modelling|Amirhossein Jafarian|
| 11:30 - 12:35 | DCM for evoked responses|Daniel Hauke|
| 12:35 - 13:35 | DCM for Cross-Spectral Densities |Dimitris Pinotsis|
| 13:35 - 14:35 | Lunch break                                          |
| 14:35 - 15:20 | DCM demo|Julia Rodriguez-Sanchez|
| 15:20 - 16:35 | Bayesian model selection and averaging|Peter Zeidman|
| 16:35 - 17:35 | Q&A clinic |Karl Friston|   

### Friday 2 June

<!--Join us on **Zoom** (Chair: Jason Taylor)-->
Practical hands-on session will take place in the computer lab. Participants can either work on SPM tutorial datasets or on their own data with the help of the faculty. There will also be an opportunity to ask questions in small tutorial groups for further discussions on the topics of the lectures. This will include a DAiSS special interest group with Dr. George O’Neill (12 pm), and several discussion groups with SPM faculty


| Time         | Event           |Location                              |
|--------------|-----------------|--------------------------------------|
| 09:30 - 10:00 | Practical day welcome and registration|Registration (Conservatory) Refreshments  (Boardroom) 12 Queen Square|
| 10:00 - 12:00 | Practical session |RM SR7, 7 Queen Square|
| 12:00 - 13:00 | DAiSS special interest group|TR7, 7 Queen Square|
| 13:00 - 14:00 | Lunch break    |Boardroom, 12 Queen Square|
| 14:00 - 18:00 | Practical Session and Closing Remarks |RM SR7, 7 Queen Square|

## Recorded online talks from previous years

|Title         | Speaker |
|--------------|-----------------------------------|
| SPM introduction and resources| [Guillaume Flandin](https://mediacentral.ucl.ac.uk/Play/63322)|
| What are we measuring with M/EEG|[Mansoureh Fahimi](https://mediacentral.ucl.ac.uk/Play/84821)|
| Data pre-processing |[Robert Seymour](https://mediacentral.ucl.ac.uk/Play/85023)|
| Data pre-processing demo |[Lydia Mardell](https://mediacentral.ucl.ac.uk/Play/84822)|
| General linear model and classical inference |[Martin Dietz](https://mediacentral.ucl.ac.uk/Play/63328)|
| Multiple comparisons problems and solutions|[Andreea Diaconescu](https://mediacentral.ucl.ac.uk/Play/71870)|
| Group M/EEG dataset analysis - demo|[Jason Taylor](https://mediacentral.ucl.ac.uk/Play/63330)|
| Analysis of Optically Pumped Magnetometers (OPM) data|[Tim Tierney](https://mediacentral.ucl.ac.uk/Play/63331)|
| Bayesian inference|[Peter Zeidman](https://mediacentral.ucl.ac.uk/Play/63334)|
| M/EEG source analysis |[Ryan Timms](https://mediacentral.ucl.ac.uk/Play/84826)|
| M/EEG source analysis -demo |[Stephanie Mellor](https://mediacentral.ucl.ac.uk/Play/84828)|
| The principles of dynamic causal modelling|[Bernadette van Wijk](https://mediacentral.ucl.ac.uk/Play/63373)|
| DCM for evoked responses|[Ryszard Auksztulewicz](https://mediacentral.ucl.ac.uk/Play/63377)|
| DCM for Cross-Spectral Densities |[Dimitris Pinotsis](https://mediacentral.ucl.ac.uk/Play/84831)|
| DCM demo|[Frederik Van de Steen](https://mediacentral.ucl.ac.uk/Play/84834)|
| Bayesian model selection and averaging|[Ulrich Stoof](https://mediacentral.ucl.ac.uk/Play/84835)|

## Installation of SPM software

### Installation with MATLAB

SPM is designed to work with MATLAB from versions 7.4 (R2007a) to 9.14 (R2023a).

[Download](https://github.com/spm/spm)  
[Installation instructions](https://www.fil.ion.ucl.ac.uk/spm/docs/installation/)

<!--### Installation without MATLAB

A standalone version of SPM is also available. Its installation does not require the availability of a MATLAB licence but you need to have administrative rights on your computer in order to install the MATLAB Compiler Runtime (MCR):

[Download: SPM standalone](https://www.fil.ion.ucl.ac.uk/spm/software/download/)  
[Installation instructions](https://en.wikibooks.org/wiki/SPM/Standalone)-->

## Data for the course demos

[Preprocessing and source analysis demo](https://www.fil.ion.ucl.ac.uk/spm/data/fusion/Preprocessing_demo.zip)

Group M/EEG dataset analysis - demo

* [Processed single-subject data](https://www.fil.ion.ucl.ac.uk/spm/data/fusion/Processed_single_subject.zip)
* [Source estimation - single subject](https://www.fil.ion.ucl.ac.uk/spm/data/fusion/For_source_estimation.zip)
* Images for group analysis: [As a single large file](https://www.fil.ion.ucl.ac.uk/spm/data/fusion/Images_all_subjects.zip) or as 4 smaller files [1](https://www.fil.ion.ucl.ac.uk/spm/data/fusion/Images_all_subjects1.zip), [2](https://www.fil.ion.ucl.ac.uk/spm/data/fusion/Images_all_subjects2.zip), [3](https://www.fil.ion.ucl.ac.uk/spm/data/fusion/Images_all_subjects3.zip), [4](https://www.fil.ion.ucl.ac.uk/spm/data/fusion/Images_all_subjects4.zip)
* [Group fMRI results](https://www.fil.ion.ucl.ac.uk/spm/data/fusion/fMRI_group_results_images.zip)
* [DCM for CSD](https://github.com/Frederikvdsteen/SPM_course_MEEG_2022)

## Tutorial datasets

### BEM file for source reconstruction
BEM file to copy in spm/canonical: [single_subj_T1_EEG_BEM.mat](https://www.fil.ion.ucl.ac.uk/spm/course/material/single_subj_T1_EEG_BEM.mat)

### EEG Single Subject Mismatch Negativity dataset
This is an 128-channel EEG single subject example data set which is used for demonstrating the usage of scripts in M/EEG pre-processing and DCM for evoked responses.

* [EEG mismatch negativity tutorial](./mmn/mmn.md)
* [Dataset](https://www.fil.ion.ucl.ac.uk/spm/data/eeg_mmn/)

### Multi-modal faces dataset
This archive contains EEG, MEG and fMRI data on the same subject within the same paradigm. It can be used to examine how various measures of face perception, such as the "N170" ERP (EEG), the "M170" ERF (MEG) and fusiform activation (fMRI), are related. For example, the localisation of the generator(s) of the N170 and/or M170 can be constrained by the fMRI activations. It also includes a high resolution anatomical MRI image (aMRI) for construction of a head-model for the EEG and MEG data, together with data from a Polhemus digitizer that can be used to coregister the EEG and MEG data with the aMRI.

* [Multimodal responses to faces tutorial](./multimodal/multimodal.md)
* [Dataset](https://www.fil.ion.ucl.ac.uk/spm/data/mmfaces/)

### Anaesthesia Depth in Rodent Data
This tutorial describes the analysis of a 2-channel Local Field Potential (LFPs) data set using dynamic causal modelling. The LFPs were recorded from a single rodent using intracranial electrodes. 

* [DCM for steady state responses tutorial](./dcm_ssr/dcm_ssr.md)
* [DCM for cross-spectral densities tutorial](./dcm_csd/dcm_csd.md)
* [Dataset](https://www.fil.ion.ucl.ac.uk/spm/data/dcm_csd/)

### Multimodal, multisubject data fusion
This dataset contains EEG, MEG, functional MRI and structural MRI data from 16 subjects who undertook multiple runs of a simple task performed on a large number of Famous, Unfamiliar and Scrambled faces.

* [Group multimodal tutorial](./multi/index.md)
* [Dataset](https://www.fil.ion.ucl.ac.uk/spm/data/fusion/)
* [Full dataset including the raw data](ftp://ftp.mrc-cbu.cam.ac.uk/personal/rik.henson/wakemandg_hensonrn/)
***
* [Multimodal Integration of M/EEG and fMRI Data in SPM paper](https://www.frontiersin.org/articles/10.3389/fnins.2019.00300/full)
* [BIDS version of the dataset](https://openneuro.org/datasets/ds000117/versions/1.0.2)
* [BIDS-based code corresponding to the paper](https://figshare.com/collections/Multimodal_integration_of_M_EEG_and_f_MRI_data_in_SPM12/4367120)

### DCM for ERP Tutorial
This tutorial data from a DCM for EEG study in Alzheimer’s disease patients and healthy aged controls by Ashley Tyrer and colleagues.

* [DCM for evoked responses tutorial](./dcm_erp/dcm_erp.md)
* [Dataset](https://www.fil.ion.ucl.ac.uk/spm/data/dcm_erp/)

### PEB Tutorial
This repository from Richard Rosch contains data and code that can be used to reproduce a dynamic causal modelling analysis for mismatch negativity and repetition suppression event related potentials measured with EEG in healthy probands under the influence of the NMDA receptor blocker ketamine. 

* [Github repository](https://github.com/roschkoenig/Ketamine_DCM)

### OPM Tutorial
under construction

### Materials from the joint SPM-Fieldtrip workshop MEG-UK 2015

* [Sensor-level stats demo](http://www.fieldtriptoolbox.org/workshop/meg-uk-2015/spm_stats) (data: [PapMcbdspmeeg_run_01_sss.zip](PapMcbdspmeeg_run_01_sss.zip))
* [Source reconstruction demo](http://www.fieldtriptoolbox.org/workshop/meg-uk-2015/spm_source)
* [DCM demo](http://www.fieldtriptoolbox.org/workshop/meg-uk-2015/dcm_tutorial) (data: [DCMdemo.zip](DCMdemo.zip))





<!--
<div class="grid cards" markdown>

-   :material-monitor:{ .lg .middle } __fMRI__

    ---

    [functional Magnetic Resonance Imaging](./fmri/index.md)

-   :material-monitor:{ .lg .middle } __VBM__

    ---

    [Voxel-Based Morphometry](./vbm/VBM-getting-started.md)

-   :material-monitor:{ .lg .middle } __DCM__

    ---

    [Dynamic Causal Modelling](./dcm/index.md)

-   :material-monitor:{ .lg .middle } __OPM__

    ---

    [Optically Pumped Magnetometers](./opm_preprocessing/introduction.md)

-   :material-monitor:{ .lg .middle } __SLOC__

    ---

    [MEG source localisation](./meg_sloc/meg_sloc.md)

-   :material-monitor:{ .lg .middle } __MULTIMODAL__

    ---

    [Multimodal responses to faces](./multimodal/multimodal.md)

-   :material-monitor:{ .lg .middle } __MULTIGROUP__

    ---

    [Group multimodal dataset](./multi/index.md)

-   :material-monitor:{ .lg .middle } __MMN__

    ---

    [EEG mismatch negativity](./mmn/mmn.md)
    
-   :material-monitor:{ .lg .middle } __DCMERP__

    ---

    [DCM for evoked responses](./dcm_erp/dcm_erp.md)

-   :material-monitor:{ .lg .middle } __DCMIR__

    ---

    [DCM for induced responses](./dcm_ir/dcm_ir.md)

-   :material-monitor:{ .lg .middle } __DCMPHASE__

    ---

    [DCM for phase coupling](./dcm_phase/dcm_phase.md)

-   :material-monitor:{ .lg .middle } __DCMSSR__

    ---

    [DCM for steady state responses](./dcm_ssr/dcm_ssr.md)

-   :material-monitor:{ .lg .middle } __DCMCSD__

    ---

    [DCM for cross-spectral densities](./dcm_csd/dcm_csd.md)

-   :material-monitor:{ .lg .middle } __MEEGCONV__

    ---

    [Convolution modelling of MEEG data](./meeg_firstlevel/meeg_firstlevel.md)

</div>
-->